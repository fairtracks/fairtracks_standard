{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/master/json/schema/fairtracks_experiment.schema.json",
    "$comment": "JSON signature: 359bc81562041add0fc335c7c12f270ea014c4b6023acc8710112bf51aadb860",
    "title": "FAIRification of Genomic Tracks JSON Schema - Experiment",
    "type": "object",
    "properties": {
        "@schema": {
            "description": "The JSON schema absolute URL. Used for link JSON data to a particular version of the JSON schema. Must match the value of 'id' in the linked schema",
            "type": "string",
            "format": "uri",
            "pattern": "^(https?|ftp)://",
            "const": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/master/json/schema/fairtracks_experiment.schema.json"
        },
        "global_id": {
            "description": "Global experiment identifier, resolvable by identifiers.org",
            "type": "string",
            "format": "curie",
            "namespace": [
                "geo",
                "ega.experiment"
            ],
            "matchType": "canonical",
            "examples": [
                "geo:GSE35583"
            ]
        },
        "local_id": {
            "description": "Submitter-local identifier (within investigation/hub) for experiment (in CURIE-format, if applicable)",
            "type": "string",
            "examples": [
                "encode:ENCSR000DQP"
            ],
            "unique": true
        },
        "study_ref": {
            "description": "Reference to the study that generated the sample (using the submitter-local identifier of the study)",
            "type": "string",
            "format": "foreign_ref",
            "examples": [
                "UW_ChipSeq"
            ],
            "foreignProperty": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/master/json/schema/fairtracks_study.schema.json#local_id"
        },
        "sample_ref": {
            "description": "Reference to the sample of the experiment (using the submitter-local identifier of the sample)",
            "type": "string",
            "format": "foreign_ref",
            "examples": [
                "geo:GSM945229"
            ],
            "foreignProperty": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/master/json/schema/fairtracks_sample.schema.json#local_id"
        },
        "aggregated_from": {
            "description": "References to external experiments used as basis for aggregated data generation (using global experiment identifiers, resolvable by identifiers.org)",
            "type": "array",
            "items": {
                "type": "string",
                "format": "curie",
                "namespace": "geo",
                "matchType": "canonical",
                "minItems": 1
            }
        },
        "technique": {
            "description": "Main technique used in experiment (e.g., laboratory, computational or statistical technique)",
            "type": "object",
            "properties": {
                "term_url": {
                    "description": "URL linking to an ontology term",
                    "type": "string",
                    "format": "term",
                    "ontology": [
                        "http://purl.obolibrary.org/obo/obi/2018-08-27/obi.owl",
                        "http://edamontology.org/EDAM_1.21.owl"
                    ],
                    "ancestors": [
                        "http://purl.obolibrary.org/obo/OBI_0000011",
                        "http://edamontology.org/operation_0004"
                    ],
                    "matchType": "exact",
                    "examples": [
                        "http://purl.obolibrary.org/obo/OBI_0002017"
                    ]
                },
                "term_value": {
                    "description": "Exact value according to the ontology used",
                    "type": "string",
                    "examples": [
                        "histone modification identification by ChIP-Seq assay"
                    ],
                    "autogenerated": true
                }
            },
            "required": [
                "term_url"
            ]
        },
        "sequence_feature": {
            "description": "Sequence feature targeted by the experiment",
            "type": "object",
            "properties": {
                "term_url": {
                    "description": "URL linking to an ontology term",
                    "type": "string",
                    "format": "term",
                    "ontology": "https://raw.githubusercontent.com/The-Sequence-Ontology/SO-Ontologies/v3.1/releases/so-xp.owl/so.owl",
                    "ancestors": "http://purl.obolibrary.org/obo/SO_0000110",
                    "matchType": "exact",
                    "examples": [
                        "http://purl.obolibrary.org/obo/SO_0001706"
                    ]
                },
                "term_value": {
                    "description": "Exact value according to the ontology used",
                    "type": "string",
                    "examples": [
                        "H3K4_trimethylation"
                    ],
                    "autogenerated": true
                }
            },
            "required": [
                "term_url"
            ]
        },
        "gene_id": {
            "description": "HGNC identifier for gene targeted by the experiment (e.g., specific transcription factor used as ChIP-seq antibody).",
            "type": "string",
            "namespace": "hgnc",
            "matchType": "canonical"
        },
        "gene_product_type": {
            "description": "Gene product type targeted by the experiment (e.g., miRNA)",
            "type": "object",
            "properties": {
                "term_url": {
                    "description": "URL linking to an ontology term",
                    "type": "string",
                    "format": "term",
                    "ontology": "http://purl.obolibrary.org/obo/ncit/releases/2019-09-09/ncit.owl",
                    "ancestors": "http://purl.obolibrary.org/obo/NCIT_C26548",
                    "matchType": "exact"
                },
                "term_value": {
                    "description": "Exact value according to the ontology used",
                    "type": "string",
                    "autogenerated": true
                }
            },
            "required": [
                "term_url"
            ]
        },
        "macromolecular_structure": {
            "description": "Macromolecular structure targeted by the experiment (e.g., chromatin strucure)",
            "type": "object",
            "properties": {
                "term_url": {
                    "description": "URL linking to an ontology term",
                    "type": "string",
                    "format": "term",
                    "ontology": "http://purl.obolibrary.org/obo/ncit/releases/2019-09-09/ncit.owl",
                    "ancestors": "http://purl.obolibrary.org/obo/NCIT_C14134",
                    "matchType": "exact"
                },
                "term_value": {
                    "description": "Exact value according to the ontology used",
                    "type": "string",
                    "autogenerated": true
                }
            },
            "required": [
                "term_url"
            ]
        },
        "phenotype": {
            "description": "Main phenotype (e.g. disease) connected to the sample",
            "type": "object",
            "$ref": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/master/json/schema/fairtracks_phenotype.schema.json"
        },
        "target_details": {
            "description": "Important details about the target of the experiment (to be included in the 'target' property)",
            "type": "string"
        },
        "target": {
            "description": "Main target of experiment, copied from 'sequence_feature', 'gene_id', 'gene_product', or 'macromolecular_structure' (and adding 'target_detail'), according to 'technique'",
            "type": "string",
            "examples": [
                "H3K4_trimethylation"
            ],
            "autogenerated": true
        },
        "lab_protocol_description": {
            "description": "Free-text description of lab protocol, or URL to such description",
            "type": "string",
            "examples": [
                "https://www.encodeproject.org/documents/8f459e88-6344-434f-8f9f-6375a9ff1880/@@download/attachment/CD20%2B_Stam_protocol.pdf"
            ]
        },
        "compute_protocol_description": {
            "description": "Free-text description of computational protocol, or URL to such description",
            "type": "string",
            "examples": [
                "https://www.encodeproject.org/documents/6f6351d4-9310-4a3b-a3c2-70ecac47b28b/@@download/attachment/ChIP-seq_Mapping_Pipeline_Overview.pdf"
            ]
        }
    },
    "required": [
        "local_id",
        "study_ref",
        "technique",
        "target"
    ],
    "anyOf": [
        {
            "required": [
                "sample_ref"
            ]
        },
        {
            "required": [
                "aggregated_from"
            ]
        }
    ],
    "allOf": [
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0000748"
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "sequence_feature": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/SO_0001747"
                            }
                        }
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0001853"
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "sequence_feature": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/SO_0000685"
                            }
                        }
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "anyOf": [
                                    {
                                        "const": "http://purl.obolibrary.org/obo/OBI_0002017"
                                    },
                                    {
                                        "const": "http://purl.obolibrary.org/obo/OBI_0000748"
                                    },
                                    {
                                        "const": "http://purl.obolibrary.org/obo/OBI_0001853"
                                    }
                                ]
                            }
                        }
                    }
                }
            },
            "then": {
                "required": [
                    "sequence_feature"
                ]
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0002019"
                            }
                        }
                    }
                }
            },
            "then": {
                "required": [
                    "gene_id"
                ]
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0001271"
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "gene_product_type": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/NCIT_C813"
                            }
                        }
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0001922"
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "gene_product_type": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/NCIT_C25966"
                            }
                        }
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0002019"
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "gene_product_type": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/NCIT_C17207"
                            }
                        }
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "anyOf": [
                                    {
                                        "const": "http://purl.obolibrary.org/obo/OBI_0001271"
                                    },
                                    {
                                        "const": "http://purl.obolibrary.org/obo/OBI_0001922"
                                    },
                                    {
                                        "const": "http://purl.obolibrary.org/obo/OBI_0002019"
                                    }
                                ]
                            }
                        }
                    }
                }
            },
            "then": {
                "required": [
                    "gene_product_type"
                ]
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0002440"
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "macromolecular_structure": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/NCIT_C13402"
                            }
                        }
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://purl.obolibrary.org/obo/OBI_0002440"
                            }
                        }
                    }
                }
            },
            "then": {
                "required": [
                    "macromolecular_structure"
                ]
            }
        },
        {
            "if": {
                "properties": {
                    "technique": {
                        "properties": {
                            "term_url": {
                                "const": "http://edamontology.org/topic_3517"
                            }
                        }
                    }
                }
            },
            "then": {
                "required": [
                    "phenotype"
                ]
            }
        }
    ],
    "additionalProperties": true
}
