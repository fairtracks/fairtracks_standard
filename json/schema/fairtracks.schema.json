{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/v1/current/json/schema/fairtracks.schema.json",
    "$version_url": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/v1/1.0.2/json/schema/fairtracks.schema.json",
    "$comment": "JSON signature: d3a1df54db68135698babd1a5a7b87dbde04d0540bce923158dbd9c9fafc7e33",
    "title": "FAIRtracks",
    "type": "object",
    "properties": {
        "@schema": {
            "title": "Schema URL",
            "description": "The absolute URL of the 'current' version of the relevant FAIRtracks JSON schema within the same major version as the JSON document follows (which should ensure compatibility). Must match the value of '$id' in the linked schema",
            "type": "string",
            "format": "uri",
            "pattern": "^(https?|ftp)://",
            "const": "https://raw.githubusercontent.com/fairtracks/fairtracks_standard/v1/current/json/schema/fairtracks.schema.json"
        },
        "document": {
            "title": "Document info",
            "description": "Information about the present FAIRtracks document (i.e. a JSON document that validates against any supported release of this JSON schema)",
            "type": "object",
            "properties": {
                "global_id": {
                    "title": "Global ID",
                    "description": "Global identifier for the FAIRtracks document, resolvable by identifiers.org ",
                    "type": "string",
                    "namespace": "doi",
                    "examples": [
                        "doi:10.5281/zenodo.3984946"
                    ]
                },
                "version_id": {
                    "title": "Version ID",
                    "description": "Version string (preferably in CURIE form) that uniquely and exactly identifies the present version of the FAIRtracks document among all versions with the same \"global_id\" identifier",
                    "type": "string",
                    "examples": [
                        "doi:10.5281/zenodo.3984947"
                    ]
                },
                "version_date": {
                    "title": "Version Date",
                    "description": "Time and date of the last modification of the present version of the FAIRtracks document",
                    "type": "string",
                    "format": "date-time",
                    "examples": [
                        "2020-07-07T19:02:59Z"
                    ]
                },
                "json_signature": {
                    "title": "JSON Signature",
                    "description": "Unique signature derived from the JSON contents of the FAIRtracks document, as defined by the \"scripts/python/json_signature.py\" module in the FAIRtracks GitHub repo (https://github.com/fairtracks/fairtracks_standard).",
                    "type": "string",
                    "examples": [
                        "9e9fa2d46112ada6c64c161c9587613cd778ec042ba65740265da1a3e8a34224"
                    ]
                },
                "ontology_versions": {
                    "title": "Version URLs to Ontologies used",
                    "description": "URLs to the version of the ontologies used in the FAIRtracks document",
                    "type": "object",
                    "properties": {
                        "http://edamontology.org/EDAM.owl": {
                            "title": "Version URL to \"EDAM Ontology\"",
                            "description": "URL to the version of \"Bioinformatics operations, data types, formats, identifiers and topics\" (EDAM Ontology) used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://edamontology.org/EDAM_[0-9]+\\.[0-9]+.owl$",
                            "examples": [
                                "http://edamontology.org/EDAM_1.21.owl"
                            ],
                            "augmented": true
                        },
                        "http://purl.obolibrary.org/obo/cl.owl": {
                            "title": "Version URL to \"Cell Ontology\"",
                            "description": "URL to the version of \"Cell Ontology\" used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://purl.obolibrary.org/obo/cl/releases/[0-9]+-[0-9]+-[0-9]+/cl.owl$",
                            "examples": [
                                "http://purl.obolibrary.org/obo/cl/releases/2020-05-21/cl.owl"
                            ],
                            "augmented": true
                        },
                        "http://www.ebi.ac.uk/efo/efo.owl": {
                            "title": "Version URL to \"Experimental Factor Ontology\"",
                            "description": "URL to the version of \"Experimental Factor Ontology\" used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://www.ebi.ac.uk/efo/releases/v[0-9]+.[0-9]+.[0-9]+/efo.owl$",
                            "examples": [
                                "http://www.ebi.ac.uk/efo/releases/v3.21.0/efo.owl"
                            ],
                            "augmented": true
                        },
                        "http://purl.obolibrary.org/obo/ncit.owl": {
                            "title": "Version URL to \"NCI Thesaurus OBO EDITION\"",
                            "description": "URL to the version of \"NCI Thesaurus OBO Edition\" used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://purl.obolibrary.org/obo/ncit/releases/[0-9]+-[0-9]+-[0-9]+/ncit.owl$",
                            "examples": [
                                "http://purl.obolibrary.org/obo/ncit/releases/2020-07-17/ncit.owl"
                            ],
                            "augmented": true
                        },
                        "http://purl.obolibrary.org/obo/obi.owl": {
                            "title": "Version URL to \"Ontology for Biomedical Investigations\"",
                            "description": "URL to the version of \"Ontology for Biomedical Investigations\" used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://purl.obolibrary.org/obo/obi/[0-9]+-[0-9]+-[0-9]+/obi.owl$",
                            "examples": [
                                "http://purl.obolibrary.org/obo/obi/2020-04-23/obi.owl"
                            ],
                            "augmented": true
                        },
                        "http://purl.obolibrary.org/obo/so.owl": {
                            "title": "Version URL to \"Sequence Ontology\"",
                            "description": "URL to the version of \"Sequence types and features ontology\" used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://purl.obolibrary.org/obo/so/[0-9]+-[0-9]+-[0-9]+/so.owl$",
                            "examples": [
                                "http://purl.obolibrary.org/obo/so/2020-08-20/so.owl"
                            ],
                            "augmented": true
                        },
                        "http://purl.obolibrary.org/obo/uberon.owl": {
                            "title": "Version URL to \"Uberon Ontology\"",
                            "description": "URL to the version of  \"Uber-anatomy ontology\" used in the JSON document",
                            "type": "string",
                            "format": "uri",
                            "pattern": "^http://purl.obolibrary.org/obo/uberon/releases/[0-9]+-[0-9]+-[0-9]+/uberon.owl$",
                            "examples": [
                                "http://purl.obolibrary.org/obo/uberon/releases/2020-06-30/uberon.owl"
                            ],
                            "augmented": true
                        }
                    },
                    "required": [
                        "http://edamontology.org/EDAM.owl",
                        "http://purl.obolibrary.org/obo/cl.owl",
                        "http://www.ebi.ac.uk/efo/efo.owl",
                        "http://purl.obolibrary.org/obo/ncit.owl",
                        "http://purl.obolibrary.org/obo/obi.owl",
                        "http://purl.obolibrary.org/obo/so.owl",
                        "http://purl.obolibrary.org/obo/uberon.owl"
                    ]
                },
                "has_augmented_metadata": {
                    "title": "Contains Augmented Metadata",
                    "description": "Set to true if the metadata properties with augmented=true is set in this document, as returned by the fairtracks_augment service",
                    "type": "boolean",
                    "examples": [
                        true
                    ]
                },
                "augmented_from": {
                    "title": "Augmented From",
                    "description": "Information about the non-augmented \"parent\" FAIRtracks document used to generate the augmented FAIRtracks document. Only relevant if 'has_augmented_data' is true",
                    "type": "object",
                    "properties": {
                        "minimal_doc_ref": {
                            "title": "Minimal Document Reference",
                            "description": "Reference to the minimal (i.e. non-augmented) FAIRtracks document used to generate the present augmented FAIRtracks document (using the global identifier of the document)",
                            "type": "string",
                            "namespace": "doi"
                        },
                        "minimal_doc_version_id": {
                            "title": "Minimal Document Version",
                            "description": "Version string (preferably in CURIE form) that uniquely identifies the exact version (among all document versions matching \"minimal_doc_ref\") of the minimal FAIRtracks document used to generate the present augmented FAIRtracks document ",
                            "type": "string"
                        }
                    },
                    "required": [
                        "minimal_doc_ref",
                        "minimal_doc_version_id"
                    ]
                }
            },
            "required": [
                "global_id",
                "version_id",
                "version_date",
                "ontology_versions",
                "has_augmented_metadata"
            ],
            "allOf": [
                {
                    "if": {
                        "properties": {
                            "document": {
                                "properties": {
                                    "has_augmented_metadata": {
                                        "const": "true"
                                    }
                                }
                            }
                        }
                    },
                    "then": {
                        "properties": {
                            "document": {
                                "required": [
                                    "augmented_from"
                                ]
                            }
                        }
                    }
                }
            ]
        },
        "collection_info": {
            "title": "Track Collection Info",
            "description": "General information about the track collection that is annotated in the current FAIRtracks JSON document",
            "type": "object",
            "properties": {
                "source_repo_url": {
                    "title": "Source Repo URL",
                    "description": "URL to the track repository containing the collection (e.g., the Track Hub Registry)",
                    "type": "string",
                    "format": "uri",
                    "pattern": "^(https?|ftp)://",
                    "examples": [
                        "https://www.encodeproject.org/search"
                    ]
                },
                "local_id": {
                    "title": "Local ID",
                    "description": "Submitter-local identifier (within track repository) for the collection",
                    "type": "string",
                    "examples": [
                        "encode_example"
                    ],
                    "unique": true
                },
                "document_ref": {
                    "title": "Document Reference",
                    "description": "Reference to the FAIRtracks document containing the track collection (using the global identifier of the document)",
                    "type": "string",
                    "format": "foreign_ref",
                    "examples": [
                        "doi:10.5281/zenodo.3984946"
                    ],
                    "foreignProperty": "fairtracks.schema.json#document/global_id"
                },
                "short_name": {
                    "title": "Name (Short)",
                    "description": "Short name of the track collection. Suggested maximum length is 17 characters",
                    "type": "string",
                    "examples": [
                        "ENCODE example"
                    ]
                },
                "long_name": {
                    "title": "Name (Long)",
                    "description": "Long name of the track collection. Suggested maximum length is 80 characters",
                    "type": "string",
                    "examples": [
                        "Example of a few tracks created by the ENCODE Project"
                    ]
                },
                "description_url": {
                    "title": "Description URL",
                    "description": "URL to a web page or file describing the track collection",
                    "type": "string",
                    "format": "uri",
                    "pattern": "^(https?|ftp)://",
                    "examples": [
                        "https://www.encodeproject.org/help/project-overview/"
                    ]
                },
                "orig_metadata_url": {
                    "title": "Original Metadata URL",
                    "description": "URL to track collection metadata in its original form (might contain more than the relevant metadata)",
                    "type": "string",
                    "format": "uri",
                    "pattern": "^(https?|ftp)://",
                    "examples": [
                        "https://www.encodeproject.org/search/?format=json"
                    ]
                },
                "contact": {
                    "title": "Contact Information",
                    "description": "Contact information for the track collection",
                    "type": "object",
                    "$ref": "fairtracks_contact.schema.json"
                }
            },
            "required": [
                "local_id",
                "document_ref",
                "short_name",
                "long_name",
                "contact"
            ]
        },
        "studies": {
            "title": "Studies",
            "description": "Array of JSON documents describing different studies that have produced data for the track collection",
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "fairtracks_study.schema.json"
            }
        },
        "experiments": {
            "title": "Experiments",
            "description": "Array of JSON documents describing the different experiments that have produced data for the track collection",
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "fairtracks_experiment.schema.json"
            }
        },
        "samples": {
            "title": "Samples",
            "description": "Array of JSON documents describing the different samples that have been analyzed to create the track collection",
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "fairtracks_sample.schema.json"
            }
        },
        "tracks": {
            "title": "Tracks",
            "description": "Array of JSON documents describing the different track files in the collection",
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "fairtracks_track.schema.json"
            }
        }
    },
    "required": [
        "@schema",
        "document",
        "collection_info",
        "studies",
        "experiments",
        "samples",
        "tracks"
    ],
    "allOf": [
        {
            "if": {
                "properties": {
                    "document": {
                        "properties": {
                            "has_augmented_metadata": {
                                "const": true
                            }
                        }
                    }
                }
            },
            "then": {
                "properties": {
                    "document": {
                        "properties": {
                            "ontology_versions": {
                                "required": [
                                    "http://edamontology.org/EDAM.owl",
                                    "http://purl.obolibrary.org/obo/cl.owl",
                                    "http://www.ebi.ac.uk/efo/efo.owl",
                                    "http://purl.obolibrary.org/obo/ncit.owl",
                                    "http://purl.obolibrary.org/obo/obi.owl",
                                    "http://purl.obolibrary.org/obo/so.owl",
                                    "http://purl.obolibrary.org/obo/uberon.owl"
                                ]
                            }
                        }
                    },
                    "studies": {
                        "items": {
                            "required": [
                                "collection_ref"
                            ]
                        }
                    },
                    "experiments": {
                        "items": {
                            "properties": {
                                "technique": {
                                    "required": [
                                        "term_label"
                                    ]
                                },
                                "target": {
                                    "properties": {
                                        "sequence_feature": {
                                            "required": [
                                                "term_label"
                                            ]
                                        },
                                        "gene_product_type": {
                                            "required": [
                                                "term_label"
                                            ]
                                        },
                                        "macromolecular_structure": {
                                            "required": [
                                                "term_label"
                                            ]
                                        },
                                        "phenotype": {
                                            "required": [
                                                "term_label"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "summary"
                                    ]
                                }
                            }
                        }
                    },
                    "samples": {
                        "items": {
                            "required": [
                                "species_name"
                            ],
                            "properties": {
                                "biospecimen_class": {
                                    "required": [
                                        "term_label"
                                    ]
                                },
                                "sample_type": {
                                    "properties": {
                                        "cell_type": {
                                            "required": [
                                                "term_label"
                                            ]
                                        },
                                        "abnormal_cell_type": {
                                            "required": [
                                                "term_label"
                                            ]
                                        },
                                        "cell_line": {
                                            "required": [
                                                "term_label"
                                            ]
                                        },
                                        "organism_part": {
                                            "required": [
                                                "term_label"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "summary"
                                    ]
                                },
                                "phenotype": {
                                    "required": [
                                        "term_label"
                                    ]
                                }
                            }
                        }
                    },
                    "tracks": {
                        "items": {
                            "required": [
                                "file_name"
                            ],
                            "properties": {
                                "file_format": {
                                    "required": [
                                        "term_label"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        }
    ],
    "additionalProperties": true
}
